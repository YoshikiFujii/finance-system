<!doctype html><html lang="ja"><meta charset="utf-8"/>
<title>Lotus - ログイン</title>
<link rel="stylesheet" href="../assets/app.css?v=1"/>
<body class="login-page">
    <main class="container">
        <h1>Lotus - ログイン</h1>
        <form id="loginForm">
            <label>
                ページ:
                <select id="role">
                    <option value="OFFICER">提出ページ（役員）</option>
                    <option value="FINANCE">財務ページ</option>
                    <option value="ADMIN">管理者ページ</option>
                </select>
            </label>
            <label>
                パスワード:
                <input id="pw" type="password" placeholder="パスワード"/>
            </label>
        </form>
        <button id="go">ログイン</button>
    </main>
<script>
async function login() {
    const role = document.getElementById('role').value;
    const password = document.getElementById('pw').value;
    const r = await fetch('/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({role,password})});
    const j = await r.json(); if(!j.ok){ alert(j.message); return; }
    location.href = role==='OFFICER'? '/pages/officer.html' : role==='FINANCE'? '/pages/finance.html' : '/pages/admin.html';
}

// ボタンクリックでログイン
document.getElementById('go').onclick = login;

// エンターキーでログイン
document.getElementById('loginForm').addEventListener('submit', (e) => {
    e.preventDefault();
    login();
});

// パスワードフィールドでエンターキーを押した時もログイン
document.getElementById('pw').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        e.preventDefault();
        login();
    }
});
</script>
</body></html>